% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/colour_cycle_summary.R
\name{print_exp_mo2s}
\alias{print_exp_mo2s}
\title{Pretty-print \eqn{MO_2} matrix for an AquaResp experiment}
\usage{
print_exp_mo2s(
  path,
  chamber_col = "chamber",
  cycle_col = "cycle",
  mo2_col = "MO2",
  r2_col = "R.2",
  min_po2_col = "minimum.po2",
  max_po2_col = "max.po2",
  r2_threshold = 0.95,
  ...
)
}
\arguments{
\item{path}{Character. Directory location of the AquaResp experiment on disk.}

\item{chamber_col}{Character. Column name for chamber IDs (default \code{"chamber"}).}

\item{cycle_col}{Character. Column name for cycle IDs (default \code{"cycle"}).}

\item{mo2_col}{Character. Column name for \eqn{MO_2} values (default \code{"MO2"}).}

\item{r2_col}{Character. Column name for \eqn{R^2} values (default \code{"R.2"}).}

\item{min_po2_col}{Character. Column name for minimum \eqn{PO_2} values (default \code{"minimum.po2"}).}

\item{max_po2_col}{Character. Column name for maximum \eqn{PO_2} values (default \code{"max.po2"}).}

\item{r2_threshold}{Numeric. Threshold for \eqn{R^2} flagging (default \code{0.95}).}

\item{...}{Additional arguments passed to \code{\link{print_matrix_exp}}.}
}
\value{
Invisibly returns \code{NULL}.
}
\description{
Reads \eqn{MO_2} data from an AquaResp experiment directory and prints a formatted matrix
with optional flags and start times for each cycle.
}
\details{
This function:
\itemize{
\item Loads AquaResp experiment data using \code{\link{get_exp_mo2s}}.
\item Validates required columns: chamber, cycle, \eqn{MO_2}, and \eqn{R^2}.
\item Checks for duplicate (cycle, chamber) combinations and stops if found.
\item Constructs:
\enumerate{
\item A matrix of \eqn{MO_2} values indexed by cycle and chamber.
\item A matrix of \eqn{R^2} values for flagging.
\item A missingness mask based on \eqn{PO_2} values.
}
\item Computes start times for each cycle and passes them as an extra column.
\item Calls \code{\link{print_matrix_exp}} to render the matrix with:
\itemize{
\item Colour-mapped values.
\item Flags for low \eqn{R^2} and missing \eqn{PO_2}.
\item A legend showing colour scale and flag meanings.
\item An extra column for cycle start times.
}
}
}
\section{Flags}{

\itemize{
\item \eqn{R^2} flag: cells where \eqn{R^2 <} \code{r2_threshold}.
\item Missing flag: cells where \eqn{PO_2} values are non-finite or \eqn{\le 0}. For example, when oxygen registers as 0 due to the computer missing a measurement, or when -300 is registered when the probe was out of position, will be flagged as missing values as these will affect \eqn{R^2} and \eqn{MO_2} estimates.
}
}

\examples{
# Example usage:
exp_dir_path <- system.file("extdata", "aquaresp_experiment",
                            package = "flatheadresp")
print_exp_mo2s(path = exp_dir_path)
}
