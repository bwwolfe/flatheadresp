% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc_exp_mo2s.R
\name{calc_exp_mo2s}
\alias{calc_exp_mo2s}
\title{Recalculate MO2 cycle outputs from AquaResp experiment data}
\usage{
calc_exp_mo2s(
  path,
  tolerance = 0.001,
  index_cols = c(cycle = "cycle", chamber = "chamber"),
  chambers = NULL,
  report = TRUE
)
}
\arguments{
\item{path}{Character. Experiment directory.}

\item{tolerance}{Numeric (non-negative). Tolerance for differences in
\code{delta.po2} and \code{R.2} to flag corrections. Defaults to \code{0.001}, as there may
be small rounding differences in the statistics calculated by this package
vs the original AquaResp logic (coded in Python).}

\item{index_cols}{Character vector of index column names to join on.
Defaults to \code{c("cycle", "chamber")}.}

\item{chambers}{Numeric. The chamber numbers to include, negative subsets will exclude those chambers.}

\item{report}{Logical. If \code{TRUE} (default), a summary is printed to the console.}
}
\value{
A data.frame with the column order described above.
}
\description{
Recalculates MO2s and related metrics from raw cycle oxygen data with the
internal function \code{cycle_summary()}. It also returns the original AquaResp
values from \code{get_exp_mo2s()}
}
\details{
A logical \code{corrected} flag is inserted after the main columns, indicating
if \code{delta.po2} or \code{R.2} differ by more than \code{tolerance}. The original values
from AquaResp are appended at the end, suffixed with \code{"_uncorrected"}.

\strong{Reporting:} When \code{calc_exp_mo2s()} runs, it reports several quality-control metrics to the console:

\itemize{
\item \strong{Number of cycles corrected:} Cycles adjusted due to bugs in AquaResp code.

\item \strong{Cycles with minimum \eqn{PO_{2} \le 0\%} saturation:}
These values are treated as missing and removed before calculating \eqn{MO_{2}} or \eqn{R^{2}}.

\item \strong{Cycles with minimum \eqn{PO_{2} < 0\%}:}
Often corresponds to erroneous values (e.g., \eqn{-300\%}) when an oxygen probe was not functioning.
If present, these cycles may indicate disturbances worth investigating.

\item \strong{Cycles with corrected \eqn{R^{2}} values:}
Corrections occur when differences exceed a tolerance (default = \eqn{0.001}).
Even without data removal, minor discrepancies can arise between AquaResp's Python calculations
and this package's implementation.

\item \strong{Additional metrics:}
\itemize{
\item Greatest rate of missing \eqn{PO_{2}} measurements in a cycle
(typically \eqn{\sim 0.1\%}; higher values may indicate the computer is missing
a lot of oxygen sensor data and may need review).
\item Number of cycles where \emph{all} chambers have \eqn{R^{2} < 0.95},
which may indicate disturbances or insufficient measurement window durations,
if they are common. This metric is also provided on a per-chamber basis.
}
}
}
\examples{
exp_dir_path <- system.file("extdata", "aquaresp_experiment", package = "flatheadresp")
calc_exp_mo2s(path = exp_dir_path)
}
